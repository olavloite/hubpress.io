<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Untitled RSS Feed]]></title><description><![CDATA[Untitled RSS Feed]]></description><link>https://olavloite.github.io</link><generator>RSS for Node</generator><lastBuildDate>Sat, 13 May 2017 10:42:18 GMT</lastBuildDate><atom:link href="https://olavloite.github.io/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[Tutorial: Use Google Cloud Spanner with Spring Boot, JPA and Hibernate]]></title><description><![CDATA[<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Google Cloud Spanner is Google&#8217;s horizontally scalable, globally consistent, relational database service. Cloud Spanner claims to be <a href="https://cloud.google.com/spanner/">the first and only relational database service that is both strongly consistent and horizontally scalable</a>. Cloud Spanner supports transactions and SQL queries and could in theory be used with any application currently running on other relational databases. This tutorial will guide you through the steps needed to set up a test environment for developing a Spring Boot application with Cloud Spanner as its data source using JPA/Hibernate.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_1_create_a_cloud_spanner_test_database">Step 1: Create a Cloud Spanner test database</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Google kindly offers a $300 in free credit for trying out Cloud Spanner. Go to <a href="https://cloud.google.com/spanner/" class="bare">https://cloud.google.com/spanner/</a> and click on Try It Free to create a test instance. Go through the registration process and then follow these steps to create a Cloud Spanner instance and database:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you register for the first time with Google Cloud, Google automatically creates a project for you with the title 'My first project' and a generated project id. Rename this project to something like <code>cloudspanner-test</code>. If you already have a Google Cloud account, you can add a new project.</p>
</li>
<li>
<p>Click on the main menu button in the top left corner next to the text Google Cloud Platform and select Spanner. Google will now initialize Cloud Spanner for your project.</p>
</li>
<li>
<p>Create an instance with these values:</p>
<div class="ulist">
<ul>
<li>
<p>Instance name: <code>Test Instance</code></p>
</li>
<li>
<p>Instance id: <code>test-instance</code></p>
</li>
<li>
<p>Configuration: your choice</p>
</li>
<li>
<p>Nodes: 1</p>
</li>
</ul>
</div>
</li>
<li>
<p>Create a database with these values:</p>
<div class="ulist">
<ul>
<li>
<p>Database name: <code>test-database</code></p>
</li>
<li>
<p>Tables: Do not create any tables now</p>
</li>
</ul>
</div>
</li>
<li>
<p>Now we will create a service account that you can use to access the database remotely. Click on the main menu button in the top left corner and select IAM &amp; Admin.</p>
</li>
<li>
<p>Click on Service accounts in the menu on the left.</p>
</li>
<li>
<p>Click on Create Service Account on top of the page.</p>
</li>
<li>
<p>Name the service account <code>spanner</code> and select the role Cloud Spanner | Cloud Spanner Admin. Turn on the option <strong>Furnish a private key</strong> and choose JSON. This key file will be downloaded to your computer and you will need it to access the database remotely. Click on Create.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>That&#8217;s it! You have now created the Google Cloud Spanner database needed for this tutorial.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_2_get_and_run_the_example_project">Step 2: Get and Run the Example Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I have created a sample project that will be used for this tutorial. Clone the project from <a href="https://github.com/olavloite/spanner-jpa-example" class="bare">https://github.com/olavloite/spanner-jpa-example</a> . It is a Maven project with a dependency on a JDBC Driver for Google Cloud Spanner and on a Hibernate Dialect library. Make sure to get these dependencies. They are available on Maven Central. Then follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Find the file <code>application.properties.example</code> in the root of the project and make a copy of this and name the copy <code>application.properties</code>.</p>
</li>
<li>
<p>Open <code>application.properties</code> and change the value of spring.datasource.url into the following string. Make sure you change the placeholder [project-id] with the project id generated by Google (this is <strong>NOT</strong> the project name). Also change the placeholder [path-to-keyfile] with the actual location on your local disk of the JSON keyfile generated in the steps above:</p>
<div class="literalblock">
<div class="content">
<pre>jdbc:cloudspanner://localhost;Project=[project-id];Instance=test-instance;Database=test-database;PvtKeyPath=[path-to-keyfile]</pre>
</div>
</div>
</li>
<li>
<p>Run the Java application (the main class is Application.class). The application is configured to automatically create the tables needed for the entities that are defined in the source code. This example project contains two entities (Customer and Invoice), and these tables will be created. Note that this process can take some time as Cloud Spanner is not very quick when it comes to DDL.</p>
</li>
<li>
<p>The application will then try to insert and then select some records into Cloud Spanner</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can try to experiment with additional entities and also try to update some of them by changing the code. Please note that the DDL statement support of Google Cloud Spanner is somewhat limited. Adding nullable columns to existing tables and adding new tables should work without any hassle. More complex changes, such as changing an existing column, might produce errors and need to be changed manually through the web interface of Google Cloud Spanner.</p>
</div>
</div>
</div>]]></description><link>https://olavloite.github.io/2017/03/11/Google-Cloud-Spanner-with-Spring-Boot-JPA-and-Hibernate.html</link><guid isPermaLink="true">https://olavloite.github.io/2017/03/11/Google-Cloud-Spanner-with-Spring-Boot-JPA-and-Hibernate.html</guid><category><![CDATA[Google_Cloud_Spanner]]></category><category><![CDATA[ Google_Cloud]]></category><category><![CDATA[ Cloud_Spanner]]></category><category><![CDATA[ Spring_Boot]]></category><category><![CDATA[ JPA]]></category><category><![CDATA[ Hibernate]]></category><category><![CDATA[ JDBC]]></category><category><![CDATA[ Java]]></category><category><![CDATA[ Open_Source]]></category><dc:creator><![CDATA[Knut Olav LÃ¸ite]]></dc:creator><pubDate>Sat, 11 Mar 2017 00:00:00 GMT</pubDate></item></channel></rss>